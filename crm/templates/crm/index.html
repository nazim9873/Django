{% extends 'crm/basic.html' %}
{% block title %} Dashboard {% endblock %}


{% block content %}
{% load static %}

<nav class="navbar navbar-expand-lg navbar-dark bg-success">
    <div class="container-fluid">
        <a class="navbar-brand fs-3 px-3" href="#">
            Aedifico Tech</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse " id="navbarNav">
            <ul class="navbar-nav flex-row flex-wrap ms-md-auto">
                <li class="nav-item col-6 col-md-auto">
                    <a class="nav-link active fs-5" aria-current="page" href="/">Dashboard</a>
                </li>
                <li class="nav-item col-6 col-md-auto">
                    <a class="nav-link fs-5" href="{% url 'crm:services' %}">Services</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle fs-5" href="{% url 'crm:enquiry' %}" id="navbarDropdown" role="button"
                       data-bs-toggle="dropdown" aria-expanded="false">
                        Enquiry
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="{% url 'crm:enquiry_search' %}">Search Enquiry</a></li>
                    </ul>
                </li>
                <li class="nav-item col-6 col-md-auto">
                    <a class="nav-link fs-5" href="{% url 'crm:registration' %}">Registration</a>
                </li>
                <li class="nav-item col-6 col-md-auto">
                    <a class="nav-link fs-5" href="{% url 'crm:payment_search' %}">Payments</a>
                </li>

                {% if user.is_authenticated %}
                <li class="nav-item col-6 col-md-auto">
                    <a class="nav-link fs-5" href="{% url 'members:logout_user' %}">Logout</a>
                </li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>

<div class="container-fluid px-0 mx-0 ">
    <img src='{% static "crm/jumbo1_new.jpg" %}' class="img-fluid">
</div>

<!--Cards-->


<div class="row p-3 pb-0">
    <div class="col">
        <div class="col-md">
            <div class="card text-center text-white mb-3 bg-dark" id="total-orders">
                <div class="card-header">
                    <h5 class="card-title">Total Enquiries</h5>
                </div>
                <div class="card-body d-grid gap-2">
                    <h3 class="card-title">123</h3>
                    <a class="btn btn-outline-light m-1 btn-sm" data-bs-toggle="modal"
                       data-bs-target="#enq">Show</a>

                </div>
            </div>
        </div>
    </div>

    <!--Modals-->
    <div class="modal fade" id="enq" tabindex="-1" data-bs-backdrop="static"
         data-bs-keyboard="false"
         aria-labelledby="regModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="enqModalLabel">Enquiries</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <table class="table table-striped table-hover">
                        <thead>
                        <tr>
                            <th scope="col">Enquiry no.</th>
                            <th scope="col">BA ID</th>
                            <th scope="col">Source</th>
                            <th scope="col">Student Name</th>
                            <th scope="col">Email</th>
                            <th scope="col">Phone</th>
                            <th scope="col">Course</th>
                            <th scope="col">Qualification</th>
                            <th scope="col">College</th>
                            <th scope="col">Location</th>
                            <th scope="col">Counsellor</th>
                            <th scope="col">Course Date</th>
                            <th scope="col">Demo Intialized</th>
                            <th scope="col">Trainer's Name</th>

                        </tr>
                        </thead>
                        <tbody>
                        {% for enq in enquirys %}
                        <tr>
                            <th scope="row">{{enq.enquiry_no}}</th>
                            <td>{{enq.ba_id}}</td>
                            <td>{{enq.sources}}</td>
                            <td><p>{{enq.student_firstname}} {{enq.student_lastname}}</p></td>
                            <td>{{enq.email}}</td>
                            <td>{{enq.phone}}</td>
                            <td>{{enq.course_name}}</td>
                            <td>{{enq.qualifications}}</td>
                            <td>{{enq.college}}</td>
                            <td>{{enq.location}}</td>
                            <td>{{enq.counsellor}}</td>
                            <td>{{enq.date}}</td>
                            <td>{{enq.demo_init}}</td>
                            <td>{{enq.trainer_name}}</td>
                        </tr>
                        {% endfor %}

                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>

    <div class="col">
        <div class="col-md">
            <div class="card text-center text-white  mb-3 bg-warning" id="total_customers">
                <div class="card-header">
                    <h5 class="card-title">Total Registrations</h5>
                </div>
                <div class="card-body d-grid gap-2">
                    <h3 class="card-title">123</h3>
                    <a class="btn btn-outline-light m-1 btn-sm" data-bs-toggle="modal"
                       data-bs-target="#reg">Show</a>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="reg" tabindex="-1" data-bs-backdrop="static"
         data-bs-keyboard="false"
         aria-labelledby="regModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="regModalLabel">Registrations</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <table class="table table-striped table-hover">
                        <thead>
                        <tr>
                            <th scope="col">Registration no.</th>
                            <th scope="col">Student Name</th>
                            <th scope="col">Email</th>
                            <th scope="col">Phone</th>
                            <th scope="col">Father's Name</th>
                            <th scope="col">Father's Contact No.</th>
                            <th scope="col">Permanent Address</th>
                            <th scope="col">Corresponding Address</th>
                            <th scope="col">Course</th>
                            <th scope="col">Duration</th>
                            <th scope="col">Registration Date</th>
                            <th scope="col">BA ID</th>
                            <th scope="col">Enrollment ID</th>
                            <th scope="col">Counsellor</th>

                        </tr>
                        </thead>
                        <tbody>
                        {% for reg in regs %}
                        <tr>
                            <th scope="row">{{reg.registration_no}}</th>
                            <td><p>{{reg.student_firstname}} {{reg.student_lastname}}</p></td>
                            <td>{{reg.email}}</td>
                            <td>{{reg.phone}}</td>
                            <td>{{reg.father_name}}</td>
                            <td>{{reg.father_phone}}</td>
                            <td>{{reg.perm_add}}</td>
                            <td>{{reg.corres_add}}</td>
                            <td>{{reg.course_name}}</td>
                            <td>{{reg.duration}}</td>
                            <td>{{reg.registration_date}}</td>
                            <td>{{reg.ba_id}}</td>
                            <td>{{reg.enroll_id}}</td>
                            <td>{{reg.cousellor}}</td>
                        </tr>
                        {% endfor %}

                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>


    <div class="col">
        <div class="col-md">
            <div class="card text-center text-white mb-3 bg-success" id="orders-delivered">
                <div class="card-header ">
                    <h5 class="card-title">Total Fees Collection</h5>
                </div>
                <div class="card-body d-grid gap-2">
                    <h3 class="card-title">200</h3>
                    <a href="#" class="btn btn-outline-light m-1 btn-sm" data-bs-toggle="modal"
                       data-bs-target="#fees">Show</a>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="fees" data-bs-backdrop="static" data-bs-keyboard="false"
         tabindex="-1" aria-labelledby="feesBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="feesBackdropLabel">Fees Collection</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <table class="table table-striped table-hover">
                        <thead>
                        <tr>
                            <th scope="col">Enrollment ID</th>
                            <th scope="col">Student Name</th>
                            <th scope="col">Course</th>
                            <th scope="col">Paid Fee</th>
                            <th scope="col">Total Fee</th>
                            <th scope="col">Pending Fee</th>
                            <th scope="col">Last Paid On</th>


                        </tr>
                        </thead>
                        <tbody>
                        {% for reg in regs %}
                        <tr>
                            <th scope="row">{{reg.enroll_id}}</th>
                            <td><p>{{reg.student_firstname}} {{reg.student_lastname}}</p></td>
                            <td>{{reg.course_name}}</td>
                            <td>{{reg.paid_fee}}</td>
                            <td>{{reg.total_fee}}</td>
                            <td>{{reg.pending_fee}}</td>
                            <td>{{reg.last_installment_date}}</td>
                        </tr>
                        {% endfor %}

                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <a href="details/" class="btn btn-secondary" type="button">Details</a>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="col">
        <div class="col-md">
            <div class="card text-center text-white  mb-3 bg-secondary" id="orders-pending">
                <div class="card-header">
                    <h5 class="card-title">Total Pending Fees</h5>
                </div>
                <div class="card-body d-grid gap-2">
                    <h3 class="card-title">466</h3>
                    <a href="#" class="btn btn-outline-light m-1 btn-sm" data-bs-toggle="modal"
                       data-bs-target="#pend">Show</a>
                </div>

            </div>
        </div>
    </div>

    <div class="modal fade" id="pend" data-bs-backdrop="static" data-bs-keyboard="false"
         tabindex="-1" aria-labelledby="pendBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="pendBackdropLabel">Pending Fees</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <table class="table table-striped table-hover">
                        <thead>
                        <tr>
                            <th scope="col">Registration no.</th>

                            <th scope="col">Student Name</th>
                            <th scope="col">Email</th>
                            <th scope="col">Phone</th>
                            <th scope="col">Father's Name</th>
                            <th scope="col">Father's Contact No.</th>
                            <th scope="col">Permanent Address</th>
                            <th scope="col">Corresponding Address</th>
                            <th scope="col">Course</th>
                            <th scope="col">Duration</th>
                            <th scope="col">Registration Date</th>
                            <th scope="col">BA ID</th>
                            <th scope="col">Enrollment ID</th>
                            <th scope="col">Counsellor</th>

                        </tr>
                        </thead>
                        <tbody>
                        {% for reg in regs %}
                        <tr>
                            <th scope="row">{{reg.registration_no}}</th>
                            <td><p>{{reg.student_firstname}} {{reg.student_lastname}}</p></td>
                            <td>{{req.email}}</td>
                            <td>{{req.phone}}</td>
                            <td>{{req.father_name}}</td>
                            <td>{{req.father_phone}}</td>
                            <td>{{req.perm_add}}</td>
                            <td>{{req.corres_add}}</td>
                            <td>{{req.course_name}}</td>
                            <td>{{req.duration}}</td>
                            <td>{{req.registration_date}}</td>
                            <td>{{req.ba_id}}</td>
                            <td>{{req.enroll_id}}</td>
                            <td>{{req.cousellor}}</td>
                        </tr>
                        {% endfor %}

                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid p-0">
    <div class="row">
        <h4 class="py-1 text-light text-center bg-dark">Current Month</h4>
        <div class="col-md-6">
            <h5 class="p-2 m-0 text-light bg-dark">New Registrations</h5>
            <table class="table table-borderless table-hover">
                <thead class="table-dark">
                <tr>
                    <th scope="col">Reg.no.</th>
                    <th scope="col">Name</th>
                    <th scope="col">Course</th>
                    <th scope="col">Total Fee</th>
                    <th scope="col">Paid Fee</th>
                    <th scope="col">Next Installment Date</th>
                </tr>
                </thead>
                <tbody>

                {% for reg in regs %}
                <tr>
                    <th scope="row">{{reg.registration_no}}</th>
                    <td><p>{{reg.student_firstname}} {{reg.student_lastname}}</p></td>
                    <td>{{reg.course_name}}</td>
                    <td>{{reg.total_fee}}</td>
                    <td>{{reg.paid_fee}}</td>
                    <td>{{reg.next_installment_date}}</td>
                </tr>
                {% endfor %}

                </tbody>
            </table>


        </div>
        <div class="col-md-6 ">
            <h5 class="p-2 m-0 text-light bg-dark">Pending Records</h5>
            <table class="table table-borderless table-hover">
                <thead class="table-dark">
                <tr>
                    <th scope="col">Reg.no.</th>
                    <th scope="col">Name</th>
                    <th scope="col">Course</th>
                    <th scope="col">Registration date</th>
                    <th scope="col">Next Installment Date</th>
                    <th scope="col">Next Installment Amount</th>

                </tr>
                </thead>
                <tbody>
                {% for reg in regs %}
                <tr>
                    <th scope="row">{{reg.registration_no}}</th>
                    <td><p>{{reg.student_firstname}} {{reg.student_lastname}}</p></td>
                    <td>{{reg.course_name}}</td>
                    <td>{{reg.registration_date}}</td>
                    <td>{{reg.next_installment_date}}</td>
                    <td>{{reg.next_installment_amt}}</td>

                </tr>
                {% endfor %}

                </tbody>
            </table>


        </div>

    </div>

    {% endblock %}
